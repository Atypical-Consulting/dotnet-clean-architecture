# Default values for clean-architecture.
# This is a YAML-formatted file.

nameOverride: ""
fullnameOverride: ""

namespace: clean-architecture

# -- Accounts API configuration
accountsApi:
  replicaCount: 2
  image:
    repository: ghcr.io/atypical-consulting/accounts-api
    tag: "latest"
    pullPolicy: IfNotPresent
  imagePullSecrets: []
  service:
    type: ClusterIP
    port: 80
    targetPort: 8080
  containerPort: 8080
  basePath: /accounts-api
  environment: Production
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  probes:
    liveness:
      path: /health
      initialDelaySeconds: 15
      periodSeconds: 20
      timeoutSeconds: 5
      failureThreshold: 3
    readiness:
      path: /health
      initialDelaySeconds: 5
      periodSeconds: 10
      timeoutSeconds: 3
      failureThreshold: 3
  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  ingress:
    enabled: true
    className: nginx
    annotations: {}
    hosts:
      - host: app.example.com
        paths:
          - path: /accounts-api
            pathType: Prefix
    tls:
      - secretName: clean-architecture-tls
        hosts:
          - app.example.com

# -- Wallet App (Blazor) configuration
walletApp:
  replicaCount: 2
  image:
    repository: ghcr.io/atypical-consulting/wallet-app
    tag: "latest"
    pullPolicy: IfNotPresent
  imagePullSecrets: []
  service:
    type: ClusterIP
    port: 80
    targetPort: 8080
  containerPort: 8080
  environment: Production
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 250m
      memory: 256Mi
  probes:
    liveness:
      path: /
      initialDelaySeconds: 10
      periodSeconds: 20
      timeoutSeconds: 5
      failureThreshold: 3
    readiness:
      path: /
      initialDelaySeconds: 5
      periodSeconds: 10
      timeoutSeconds: 3
      failureThreshold: 3
  ingress:
    enabled: true
    className: nginx
    annotations: {}
    hosts:
      - host: app.example.com
        paths:
          - path: /
            pathType: Prefix
    tls:
      - secretName: clean-architecture-tls
        hosts:
          - app.example.com

# -- PostgreSQL configuration
postgresql:
  enabled: true
  image:
    repository: postgres
    tag: "17"
    pullPolicy: IfNotPresent
  port: 5432
  database: Accounts
  username: postgres
  # Password is stored in a Kubernetes Secret, not here.
  # Set via --set postgresql.password=... or external secret manager.
  password: ""
  service:
    type: ClusterIP
    port: 5432
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 1Gi
  persistence:
    enabled: true
    storageClass: ""
    accessModes:
      - ReadWriteOnce
    size: 10Gi
  probes:
    liveness:
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 6
    readiness:
      initialDelaySeconds: 5
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 6
